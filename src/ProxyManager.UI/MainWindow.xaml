<Window x:Class="ProxyManager.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ChangeFuckingIP" Height="550" Width="1020"
        WindowStartupLocation="CenterScreen" ResizeMode="CanMinimize"
        Icon="app.ico">

    <Grid Margin="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="130"/>
        </Grid.RowDefinitions>
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Левая панель -->
        <StackPanel Grid.Row="0" Grid.Column="0" Margin="5,0,5,0">
            
            <!-- Блок текущего соединения -->
            <GroupBox Header="Текущее соединение" Padding="5">
                <StackPanel>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="IP:" VerticalAlignment="Center"/>
                        <TextBox x:Name="TxtIp" Grid.Column="1" Text="Проверка..." IsReadOnly="True"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Location:" VerticalAlignment="Center"/>
                        <TextBox x:Name="TxtLocation" Grid.Column="1" Text="-" IsReadOnly="True"/>
                    </Grid>
                    <Grid Margin="0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="80"/>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="Hostname:" VerticalAlignment="Center"/>
                        <TextBox x:Name="TxtHostname" Grid.Column="1" Text="-" IsReadOnly="True"/>
                    </Grid>

                    <Button x:Name="BtnCheckIp" Content="Обновить информацию" Margin="0,5,0,0" Height="25" Click="BtnCheckIp_Click"/>
                </StackPanel>
            </GroupBox>

            <!-- Блок управления прокси -->
            <GroupBox Header="Управление Прокси" Margin="0,10,0,0" Padding="5">
                <StackPanel>
                    <TextBlock Text="Выберите или найдите прокси:" Margin="0,0,0,5"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <ComboBox x:Name="CmbProxies" 
                                  IsEditable="True" 
                                  IsTextSearchEnabled="True"
                                  IsTextSearchCaseSensitive="False"
                                  MaxDropDownHeight="300"
                                  DropDownOpened="CmbProxies_DropDownOpened"
                                  KeyDown="CmbProxies_KeyDown">
                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="ComboBoxItem">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Name}" Value="">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Name}" Value="{x:Null}">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBox.ItemContainerStyle>
                        </ComboBox>
                        
                        <Button x:Name="BtnEditProxies" Content="⚙" Width="30" Margin="5,0,0,0" Grid.Column="1" 
                                ToolTip="Редактор прокси" Click="BtnEditProxies_Click"/>
                    </Grid>

                    <CheckBox x:Name="ChkWatchdog" 
                              Content="Удерживать (Watchdog)" 
                              Margin="0,10,0,0"
                              IsChecked="True"/>

                    <Grid Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Button x:Name="BtnApply" Content="Применить" Margin="0,0,2,0" Height="30" Click="BtnApply_Click"/>
                        <Button x:Name="BtnReset" Content="Сбросить" Grid.Column="1" Margin="2,0,0,0" Height="30" Click="BtnReset_Click">
                            <Button.ToolTip>
                                <ToolTip>
                                    <StackPanel>
                                        <TextBlock FontWeight="Bold" Text="Сброс прокси"/>
                                        <TextBlock Text="Нажмите ЛКМ, чтобы сбросить на 'По умолчанию' (или Direct)."/>
                                        <TextBlock Text="Нажмите ПКМ, чтобы забыть сохраненный дефолт." FontStyle="Italic" Foreground="Gray"/>
                                    </StackPanel>
                                </ToolTip>
                            </Button.ToolTip>
                            <Button.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Забыть/Сбросить 'Прокси по умолчанию'" Click="BtnClearDefault_Click"/>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>
                    </Grid>
                </StackPanel>
            </GroupBox>
        </StackPanel>

        <!-- Правая панель с картинкой -->
        <Border Grid.Row="0" Grid.Column="1" BorderBrush="Gray" BorderThickness="1">
            <Image Source="Images/diesel.jpeg" Stretch="UniformToFill"/>
        </Border>

        <!-- Журнал событий -->
        <GroupBox Header="Журнал событий" Grid.Row="1" Grid.ColumnSpan="2" Margin="5,0,5,5" Padding="5">
            <ListBox x:Name="ListLog" Background="White" Foreground="Black" FontFamily="Consolas" FontSize="11" BorderThickness="0"/>
        </GroupBox>

    </Grid>
</Window>